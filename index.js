(()=>{"use strict";var t,e,r,n,s={265:(t,e,r)=>{r.a(t,(async(t,e)=>{try{var n=r(923),s=r(304);const i=await fetch("sysroot.tar");if(!i.ok)throw new Error("failed to get sysroot tarball");const a=await i.bytes(),o=(0,s.x)(a);let f=100;class l extends n.ZH{constructor(t,e){super(t,e),this.ino=BigInt(e.ino)}stat(){let t=new n.J.lGR(n.J.bqX,this.size);return t.ino=this.ino,t}}class d extends n.__{constructor(t,e){super(t),this.ino=BigInt(e)}stat(){let t=new n.J.lGR(n.J.lNn,0n);return t.ino=this.ino,t}}function u(t,e=void 0){let r=e;void 0===e&&(r=[]);for(const e in t){const n=t[e];if(n instanceof Uint8Array){const t=new l(n,{readonly:!0,ino:f++});r.push([e,t])}else{const t=u(n);r.push([e,t])}}return void 0===e?new d(r,f++):new n.xy(".",r)}const c=u(o,[["tmp",new d(new Map,f++)],["test.c",new l(new TextEncoder("utf-8").encode('#include<stdio.h>\nint main() {printf("Hewwo world? %d\\n", 12345);return 0;}\n'),{ino:f++})],["test.ld",new l(new TextEncoder("utf-8").encode("__flash = 0x08000000;\n__flash_size = 1M;\n__ram = 0x20000000;\n__ram_size = 16k;\n__stack_size = 512;\nINCLUDE picolibcpp.ld\n"),{ino:f++})]]);let _=await WebAssembly.compileStreaming(fetch("llvm.wasm"));async function p(){let t=[new n.TG(new n.ZH([])),n.Pn.lineBuffered((t=>console.log(`[WASI stdout] ${t}`))),n.Pn.lineBuffered((t=>console.warn(`[WASI stderr] ${t}`))),c],e=new n.bJ(["clang","-cc1","-triple","thumbv6m-unknown-none-eabi","-emit-obj","-dumpdir","a-","-disable-free","-clear-ast-before-backend","-main-file-name","test.c","-mrelocation-model","static","-mframe-pointer=all","-fmath-errno","-ffp-contract=on","-fno-rounding-math","-mconstructor-aliases","-nostdsysteminc","-target-cpu","cortex-m0","-target-feature","+soft-float-abi","-target-feature","-vfp2","-target-feature","-vfp2sp","-target-feature","-vfp3","-target-feature","-vfp3d16","-target-feature","-vfp3d16sp","-target-feature","-vfp3sp","-target-feature","-fp16","-target-feature","-vfp4","-target-feature","-vfp4d16","-target-feature","-vfp4d16sp","-target-feature","-vfp4sp","-target-feature","-fp-armv8","-target-feature","-fp-armv8d16","-target-feature","-fp-armv8d16sp","-target-feature","-fp-armv8sp","-target-feature","-fullfp16","-target-feature","-fp64","-target-feature","-d32","-target-feature","-neon","-target-feature","-sha2","-target-feature","-aes","-target-feature","-dotprod","-target-feature","-fp16fml","-target-feature","-bf16","-target-feature","-mve.fp","-target-feature","-fpregs","-target-feature","+strict-align","-target-abi","aapcs","-mfloat-abi","soft","-Wunaligned-access","-debugger-tuning=gdb","-fdebug-compilation-dir=/","-fcoverage-compilation-dir=/","-resource-dir","sysroot","-isysroot","sysroot","-internal-isystem","sysroot/include","-internal-isystem","sysroot/cm01-exc-rtti/include","-internal-isystem","sysroot/cm01/include","-O2","-ferror-limit","19","-fno-signed-char","-fgnuc-version=4.2.1","-fskip-odr-check-in-gmf","-vectorize-loops","-vectorize-slp","-faddrsig","-o","tmp/asdf.o","-x","c","test.c"],[],t),r=await WebAssembly.instantiate(_,{wasi_snapshot_preview1:e.wasiImport});e.start(r),console.log("COMPILE OKAY!")}async function h(){let t=[new n.TG(new n.ZH([])),n.Pn.lineBuffered((t=>console.log(`[WASI stdout] ${t}`))),n.Pn.lineBuffered((t=>console.warn(`[WASI stderr] ${t}`))),c],e=new n.bJ(["ld.lld","tmp/asdf.o","--gc-sections","-Ttest.ld","-lcrt0","-ldummyhost","-Bstatic","-EL","-Lsysroot/cm01-exc-rtti/lib","-Lsysroot/cm01/lib","-Lsysroot/lib/armv6m-unknown-none-eabi","-Lsysroot/cm01-exc-rtti/lib","-Lsysroot/cm01/lib","-lc","-lm","sysroot/cm01/lib/libclang_rt.builtins.a","--target2=rel","-o","a.out"],[],t),r=await WebAssembly.instantiate(_,{wasi_snapshot_preview1:e.wasiImport});e.start(r),console.log("LINK OKAY!")}await p(),await h();const y=c.dir.contents.get("a.out").data,g=new Blob([y],{type:"application/x-elf"}),m=URL.createObjectURL(g);let w=document.createElement("a");w.href=m,w.download="a.out",w.style="display: none",document.body.appendChild(w),w.click(),w.remove(),URL.revokeObjectURL(m),e()}catch(b){e(b)}}),1)},304:(t,e,r)=>{r.d(e,{x:()=>i});const n=new TextDecoder;function s(t,e,r){let s=0;for(;0!=t[e+s]&&s<r;)s++;return n.decode(t.slice(e,e+s))}function i(t){let e={},r=0;for(;r<=t.length&&r!=t.length-1024;){let n=s(t,r+0,100);const i=t[r+156],a=s(t,r+345,155);if(0!=a.length&&(n=a+"/"+n),53==i){const t=n.split("/");let s=e;for(let e=0;e<t.length-2;e++)s=s[t[e]];s[t[t.length-2]]={},r+=512}else if(48==i){const i=s(t,r+124,11),a=parseInt(i,8),o=512*((a+511)/512|0),f=t.slice(r+512,r+512+a),l=n.split("/");let d=e;for(let t=0;t<l.length-1;t++)d=d[l[t]];d[l[l.length-1]]=f,r+=512+o}else{if(49!=i)throw new Error("unimplemented!");{const i=s(t,r+157,100).split("/");let a=e;for(const t of i)a=a[t];const o=n.split("/");let f=e;for(let t=0;t<o.length-1;t++)f=f[o[t]];f[o[o.length-1]]=a,r+=512}}}return e}new TextDecoder},923:(t,e,r)=>{r.d(e,{Pn:()=>K,__:()=>C,ZH:()=>H,TG:()=>G,xy:()=>q,bJ:()=>J,J:()=>n});var n={};r.r(n),r.d(n,{rMm:()=>i,KOl:()=>s,esx:()=>x,TDZ:()=>I,pdx:()=>o,bMI:()=>f,Ch$:()=>l,p7p:()=>d,rJp:()=>u,yG8:()=>c,ERc:()=>_,BZn:()=>m,M1J:()=>p,efI:()=>h,jY0:()=>y,EqF:()=>g,zIp:()=>a,Nt5:()=>T,_z5:()=>B,lNn:()=>A,bqX:()=>D,LBw:()=>j,lGR:()=>N,D1b:()=>b,Rp4:()=>L,ffk:()=>z,o7e:()=>E,cTP:()=>V,Qh1:()=>M,L5A:()=>w,wZF:()=>k,vie:()=>v,s6s:()=>U});const s=0,i=1,a=0,o=8,f=20,l=28,d=31,u=37,c=44,_=52,p=54,h=55,y=58,g=63,m=76,w=64;class b{static read_bytes(t,e){const r=new b;return r.buf=t.getUint32(e,!0),r.buf_len=t.getUint32(e+4,!0),r}static read_bytes_array(t,e,r){const n=[];for(let s=0;s<r;s++)n.push(b.read_bytes(t,e+8*s));return n}}class x{static read_bytes(t,e){const r=new x;return r.buf=t.getUint32(e,!0),r.buf_len=t.getUint32(e+4,!0),r}static read_bytes_array(t,e,r){const n=[];for(let s=0;s<r;s++)n.push(x.read_bytes(t,e+8*s));return n}}const U=0,k=1,v=2,B=2,A=3,D=4;class I{head_length(){return 24}name_length(){return this.dir_name.byteLength}write_head_bytes(t,e){t.setBigUint64(e,this.d_next,!0),t.setBigUint64(e+8,this.d_ino,!0),t.setUint32(e+16,this.dir_name.length,!0),t.setUint8(e+20,this.d_type)}write_name_bytes(t,e,r){t.set(this.dir_name.slice(0,Math.min(this.dir_name.byteLength,r)),e)}constructor(t,e,r){this.d_ino=0n;const n=(new TextEncoder).encode(e);this.d_next=t,this.d_namlen=n.byteLength,this.d_type=r,this.dir_name=n}}const T=1;class j{write_bytes(t,e){t.setUint8(e,this.fs_filetype),t.setUint16(e+2,this.fs_flags,!0),t.setBigUint64(e+8,this.fs_rights_base,!0),t.setBigUint64(e+16,this.fs_rights_inherited,!0)}constructor(t,e){this.fs_rights_base=0n,this.fs_rights_inherited=0n,this.fs_filetype=t,this.fs_flags=e}}const L=1,z=2,E=4,V=8;class N{write_bytes(t,e){t.setBigUint64(e,this.dev,!0),t.setBigUint64(e+8,this.ino,!0),t.setUint8(e+16,this.filetype),t.setBigUint64(e+24,this.nlink,!0),t.setBigUint64(e+32,this.size,!0),t.setBigUint64(e+38,this.atim,!0),t.setBigUint64(e+46,this.mtim,!0),t.setBigUint64(e+52,this.ctim,!0)}constructor(t,e){this.dev=0n,this.ino=0n,this.nlink=0n,this.atim=0n,this.mtim=0n,this.ctim=0n,this.filetype=t,this.size=e}}class S{write_bytes(t,e){t.setUint32(e,this.pr_name.byteLength,!0)}constructor(t){this.pr_name=(new TextEncoder).encode(t)}}class M{static dir(t){const e=new M;return e.tag=0,e.inner=new S(t),e}write_bytes(t,e){t.setUint32(e,this.tag,!0),this.inner.write_bytes(t,e+4)}}const P=new class{enable(t){this.log=function(t,e){return t?console.log.bind(console,"%c%s","color: #265BA0",e):()=>{}}(void 0===t||t,this.prefix)}get enabled(){return this.isEnabled}constructor(t){this.isEnabled=t,this.prefix="wasi:",this.enable(t)}}(!1);class O extends Error{constructor(t){super("exit with exit code "+t),this.code=t}}let J=class{start(t){this.inst=t;try{return t.exports._start(),0}catch(t){if(t instanceof O)return t.code;throw t}}initialize(t){this.inst=t,t.exports._initialize&&t.exports._initialize()}constructor(t,e,r,n={}){this.args=[],this.env=[],this.fds=[],P.enable(n.debug),this.args=t,this.env=e,this.fds=r;const f=this;this.wasiImport={args_sizes_get(t,e){const r=new DataView(f.inst.exports.memory.buffer);r.setUint32(t,f.args.length,!0);let n=0;for(const t of f.args)n+=t.length+1;return r.setUint32(e,n,!0),P.log(r.getUint32(t,!0),r.getUint32(e,!0)),0},args_get(t,e){const r=new DataView(f.inst.exports.memory.buffer),n=new Uint8Array(f.inst.exports.memory.buffer),s=e;for(let s=0;s<f.args.length;s++){r.setUint32(t,e,!0),t+=4;const i=(new TextEncoder).encode(f.args[s]);n.set(i,e),r.setUint8(e+i.length,0),e+=i.length+1}return P.enabled&&P.log(new TextDecoder("utf-8").decode(n.slice(s,e))),0},environ_sizes_get(t,e){const r=new DataView(f.inst.exports.memory.buffer);r.setUint32(t,f.env.length,!0);let n=0;for(const t of f.env)n+=t.length+1;return r.setUint32(e,n,!0),P.log(r.getUint32(t,!0),r.getUint32(e,!0)),0},environ_get(t,e){const r=new DataView(f.inst.exports.memory.buffer),n=new Uint8Array(f.inst.exports.memory.buffer),s=e;for(let s=0;s<f.env.length;s++){r.setUint32(t,e,!0),t+=4;const i=(new TextEncoder).encode(f.env[s]);n.set(i,e),r.setUint8(e+i.length,0),e+=i.length+1}return P.enabled&&P.log(new TextDecoder("utf-8").decode(n.slice(s,e))),0},clock_res_get(t,e){let r;switch(t){case i:r=5000n;break;case s:r=1000000n;break;default:return _}return new DataView(f.inst.exports.memory.buffer).setBigUint64(e,r,!0),a},clock_time_get(t,e,r){const n=new DataView(f.inst.exports.memory.buffer);if(t===s)n.setBigUint64(r,1000000n*BigInt((new Date).getTime()),!0);else if(t==i){let t;try{t=BigInt(Math.round(1e6*performance.now()))}catch(e){t=0n}n.setBigUint64(r,t,!0)}else n.setBigUint64(r,0n,!0);return 0},fd_advise:(t,e,r,n)=>null!=f.fds[t]?a:o,fd_allocate:(t,e,r)=>null!=f.fds[t]?f.fds[t].fd_allocate(e,r):o,fd_close(t){if(null!=f.fds[t]){const e=f.fds[t].fd_close();return f.fds[t]=void 0,e}return o},fd_datasync:t=>null!=f.fds[t]?f.fds[t].fd_sync():o,fd_fdstat_get(t,e){if(null!=f.fds[t]){const{ret:r,fdstat:n}=f.fds[t].fd_fdstat_get();return null!=n&&n.write_bytes(new DataView(f.inst.exports.memory.buffer),e),r}return o},fd_fdstat_set_flags:(t,e)=>null!=f.fds[t]?f.fds[t].fd_fdstat_set_flags(e):o,fd_fdstat_set_rights:(t,e,r)=>null!=f.fds[t]?f.fds[t].fd_fdstat_set_rights(e,r):o,fd_filestat_get(t,e){if(null!=f.fds[t]){const{ret:r,filestat:n}=f.fds[t].fd_filestat_get();return null!=n&&n.write_bytes(new DataView(f.inst.exports.memory.buffer),e),r}return o},fd_filestat_set_size:(t,e)=>null!=f.fds[t]?f.fds[t].fd_filestat_set_size(e):o,fd_filestat_set_times:(t,e,r,n)=>null!=f.fds[t]?f.fds[t].fd_filestat_set_times(e,r,n):o,fd_pread(t,e,r,n,s){const i=new DataView(f.inst.exports.memory.buffer),l=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const o=b.read_bytes_array(i,e,r);let d=0;for(const e of o){const{ret:r,data:o}=f.fds[t].fd_pread(e.buf_len,n);if(r!=a)return i.setUint32(s,d,!0),r;if(l.set(o,e.buf),d+=o.length,n+=BigInt(o.length),o.length!=e.buf_len)break}return i.setUint32(s,d,!0),a}return o},fd_prestat_get(t,e){const r=new DataView(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const{ret:n,prestat:s}=f.fds[t].fd_prestat_get();return null!=s&&s.write_bytes(r,e),n}return o},fd_prestat_dir_name(t,e,r){if(null!=f.fds[t]){const{ret:n,prestat:s}=f.fds[t].fd_prestat_get();if(null==s)return n;const i=s.inner.pr_name;return new Uint8Array(f.inst.exports.memory.buffer).set(i.slice(0,r),e),i.byteLength>r?u:a}return o},fd_pwrite(t,e,r,n,s){const i=new DataView(f.inst.exports.memory.buffer),l=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const o=x.read_bytes_array(i,e,r);let d=0;for(const e of o){const r=l.slice(e.buf,e.buf+e.buf_len),{ret:o,nwritten:u}=f.fds[t].fd_pwrite(r,n);if(o!=a)return i.setUint32(s,d,!0),o;if(d+=u,n+=BigInt(u),u!=r.byteLength)break}return i.setUint32(s,d,!0),a}return o},fd_read(t,e,r,n){const s=new DataView(f.inst.exports.memory.buffer),i=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const o=b.read_bytes_array(s,e,r);let l=0;for(const e of o){const{ret:r,data:o}=f.fds[t].fd_read(e.buf_len);if(r!=a)return s.setUint32(n,l,!0),r;if(i.set(o,e.buf),l+=o.length,o.length!=e.buf_len)break}return s.setUint32(n,l,!0),a}return o},fd_readdir(t,e,r,n,s){const i=new DataView(f.inst.exports.memory.buffer),a=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]){let o=0;for(;;){const{ret:l,dirent:d}=f.fds[t].fd_readdir_single(n);if(0!=l)return i.setUint32(s,o,!0),l;if(null==d)break;if(r-o<d.head_length()){o=r;break}const u=new ArrayBuffer(d.head_length());if(d.write_head_bytes(new DataView(u),0),a.set(new Uint8Array(u).slice(0,Math.min(u.byteLength,r-o)),e),e+=d.head_length(),o+=d.head_length(),r-o<d.name_length()){o=r;break}d.write_name_bytes(a,e,r-o),e+=d.name_length(),o+=d.name_length(),n=d.d_next}return i.setUint32(s,o,!0),0}return o},fd_renumber(t,e){if(null!=f.fds[t]&&null!=f.fds[e]){const r=f.fds[e].fd_close();return 0!=r?r:(f.fds[e]=f.fds[t],f.fds[t]=void 0,0)}return o},fd_seek(t,e,r,n){const s=new DataView(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const{ret:i,offset:a}=f.fds[t].fd_seek(e,r);return s.setBigInt64(n,a,!0),i}return o},fd_sync:t=>null!=f.fds[t]?f.fds[t].fd_sync():o,fd_tell(t,e){const r=new DataView(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const{ret:n,offset:s}=f.fds[t].fd_tell();return r.setBigUint64(e,s,!0),n}return o},fd_write(t,e,r,n){const s=new DataView(f.inst.exports.memory.buffer),i=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const o=x.read_bytes_array(s,e,r);let l=0;for(const e of o){const r=i.slice(e.buf,e.buf+e.buf_len),{ret:o,nwritten:d}=f.fds[t].fd_write(r);if(o!=a)return s.setUint32(n,l,!0),o;if(l+=d,d!=r.byteLength)break}return s.setUint32(n,l,!0),a}return o},path_create_directory(t,e,r){const n=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const s=new TextDecoder("utf-8").decode(n.slice(e,e+r));return f.fds[t].path_create_directory(s)}return o},path_filestat_get(t,e,r,n,s){const i=new DataView(f.inst.exports.memory.buffer),a=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const o=new TextDecoder("utf-8").decode(a.slice(r,r+n)),{ret:l,filestat:d}=f.fds[t].path_filestat_get(e,o);return null!=d&&d.write_bytes(i,s),l}return o},path_filestat_set_times(t,e,r,n,s,i,a){const l=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const o=new TextDecoder("utf-8").decode(l.slice(r,r+n));return f.fds[t].path_filestat_set_times(e,o,s,i,a)}return o},path_link(t,e,r,n,s,i,a){const l=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]&&null!=f.fds[s]){const o=new TextDecoder("utf-8").decode(l.slice(r,r+n)),d=new TextDecoder("utf-8").decode(l.slice(i,i+a)),{ret:u,inode_obj:c}=f.fds[t].path_lookup(o,e);return null==c?u:f.fds[s].path_link(d,c,!1)}return o},path_open(t,e,r,n,s,i,a,l,d){const u=new DataView(f.inst.exports.memory.buffer),c=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const o=new TextDecoder("utf-8").decode(c.slice(r,r+n));P.log(o);const{ret:_,fd_obj:p}=f.fds[t].path_open(e,o,s,i,a,l);if(0!=_)return _;f.fds.push(p);const h=f.fds.length-1;return u.setUint32(d,h,!0),0}return o},path_readlink(t,e,r,n,s,i){const a=new DataView(f.inst.exports.memory.buffer),l=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const d=new TextDecoder("utf-8").decode(l.slice(e,e+r));P.log(d);const{ret:u,data:c}=f.fds[t].path_readlink(d);if(null!=c){const t=(new TextEncoder).encode(c);if(t.length>s)return a.setUint32(i,0,!0),o;l.set(t,n),a.setUint32(i,t.length,!0)}return u}return o},path_remove_directory(t,e,r){const n=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const s=new TextDecoder("utf-8").decode(n.slice(e,e+r));return f.fds[t].path_remove_directory(s)}return o},path_rename(t,e,r,n,s,i){const l=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]&&null!=f.fds[n]){const o=new TextDecoder("utf-8").decode(l.slice(e,e+r)),d=new TextDecoder("utf-8").decode(l.slice(s,s+i));let{ret:u,inode_obj:c}=f.fds[t].path_unlink(o);if(null==c)return u;if(u=f.fds[n].path_link(d,c,!0),u!=a&&f.fds[t].path_link(o,c,!0)!=a)throw"path_link should always return success when relinking an inode back to the original place";return u}return o},path_symlink(t,e,r,n,s){const i=new Uint8Array(f.inst.exports.memory.buffer);return null!=f.fds[r]?(new TextDecoder("utf-8").decode(i.slice(t,t+e)),new TextDecoder("utf-8").decode(i.slice(n,n+s)),y):o},path_unlink_file(t,e,r){const n=new Uint8Array(f.inst.exports.memory.buffer);if(null!=f.fds[t]){const s=new TextDecoder("utf-8").decode(n.slice(e,e+r));return f.fds[t].path_unlink_file(s)}return o},poll_oneoff(t,e,r){throw"async io not supported"},proc_exit(t){throw new O(t)},proc_raise(t){throw"raised signal "+t},sched_yield(){},random_get(t,e){const r=new Uint8Array(f.inst.exports.memory.buffer);for(let n=0;n<e;n++)r[t+n]=256*Math.random()|0},sock_recv(t,e,r){throw"sockets not supported"},sock_send(t,e,r){throw"sockets not supported"},sock_shutdown(t,e){throw"sockets not supported"},sock_accept(t,e){throw"sockets not supported"}}}};class W{fd_allocate(t,e){return y}fd_close(){return 0}fd_fdstat_get(){return{ret:y,fdstat:null}}fd_fdstat_set_flags(t){return y}fd_fdstat_set_rights(t,e){return y}fd_filestat_get(){return{ret:y,filestat:null}}fd_filestat_set_size(t){return y}fd_filestat_set_times(t,e,r){return y}fd_pread(t,e){return{ret:y,data:new Uint8Array}}fd_prestat_get(){return{ret:y,prestat:null}}fd_pwrite(t,e){return{ret:y,nwritten:0}}fd_read(t){return{ret:y,data:new Uint8Array}}fd_readdir_single(t){return{ret:y,dirent:null}}fd_seek(t,e){return{ret:y,offset:0n}}fd_sync(){return 0}fd_tell(){return{ret:y,offset:0n}}fd_write(t){return{ret:y,nwritten:0}}path_create_directory(t){return y}path_filestat_get(t,e){return{ret:y,filestat:null}}path_filestat_set_times(t,e,r,n,s){return y}path_link(t,e,r){return y}path_unlink(t){return{ret:y,inode_obj:null}}path_lookup(t,e){return{ret:y,inode_obj:null}}path_open(t,e,r,n,s,i){return{ret:p,fd_obj:null}}path_readlink(t){return{ret:y,data:null}}path_remove_directory(t){return y}path_rename(t,e,r){return y}path_unlink_file(t){return y}}class R{}class G extends W{fd_allocate(t,e){if(this.file.size>t+e);else{const r=new Uint8Array(Number(t+e));r.set(this.file.data,0),this.file.data=r}return a}fd_fdstat_get(){return{ret:0,fdstat:new j(D,0)}}fd_filestat_set_size(t){if(this.file.size>t)this.file.data=new Uint8Array(this.file.data.buffer.slice(0,Number(t)));else{const e=new Uint8Array(Number(t));e.set(this.file.data,0),this.file.data=e}return a}fd_read(t){const e=this.file.data.slice(Number(this.file_pos),Number(this.file_pos+BigInt(t)));return this.file_pos+=BigInt(e.length),{ret:0,data:e}}fd_pread(t,e){return{ret:0,data:this.file.data.slice(Number(e),Number(e+BigInt(t)))}}fd_seek(t,e){let r;switch(e){case U:r=t;break;case k:r=this.file_pos+t;break;case v:r=BigInt(this.file.data.byteLength)+t;break;default:return{ret:l,offset:0n}}return r<0?{ret:l,offset:0n}:(this.file_pos=r,{ret:0,offset:this.file_pos})}fd_tell(){return{ret:0,offset:this.file_pos}}fd_write(t){if(this.file.readonly)return{ret:o,nwritten:0};if(this.file_pos+BigInt(t.byteLength)>this.file.size){const e=this.file.data;this.file.data=new Uint8Array(Number(this.file_pos+BigInt(t.byteLength))),this.file.data.set(e)}return this.file.data.set(t,Number(this.file_pos)),this.file_pos+=BigInt(t.byteLength),{ret:0,nwritten:t.byteLength}}fd_pwrite(t,e){if(this.file.readonly)return{ret:o,nwritten:0};if(e+BigInt(t.byteLength)>this.file.size){const r=this.file.data;this.file.data=new Uint8Array(Number(e+BigInt(t.byteLength))),this.file.data.set(r)}return this.file.data.set(t,Number(e)),{ret:0,nwritten:t.byteLength}}fd_filestat_get(){return{ret:0,filestat:this.file.stat()}}constructor(t){super(),this.file_pos=0n,this.file=t}}class Z extends W{fd_seek(t,e){return{ret:o,offset:0n}}fd_tell(){return{ret:o,offset:0n}}fd_allocate(t,e){return o}fd_fdstat_get(){return{ret:0,fdstat:new j(A,0)}}fd_readdir_single(t){if(P.enabled&&(P.log("readdir_single",t),P.log(t,this.dir.contents.keys())),0n==t)return{ret:a,dirent:new I(1n,".",A)};if(1n==t)return{ret:a,dirent:new I(2n,"..",A)};if(t>=BigInt(this.dir.contents.size)+2n)return{ret:0,dirent:null};const[e,r]=Array.from(this.dir.contents.entries())[Number(t-2n)];return{ret:0,dirent:new I(t+1n,e,r.stat().filetype)}}path_filestat_get(t,e){const{ret:r,path:n}=$.from(e);if(null==n)return{ret:r,filestat:null};const{ret:s,entry:i}=this.dir.get_entry_for_path(n);return null==i?{ret:s,filestat:null}:{ret:0,filestat:i.stat()}}path_lookup(t,e){const{ret:r,path:n}=$.from(t);if(null==n)return{ret:r,inode_obj:null};const{ret:s,entry:i}=this.dir.get_entry_for_path(n);return null==i?{ret:s,inode_obj:null}:{ret:a,inode_obj:i}}path_open(t,e,r,n,s,i){const{ret:a,path:o}=$.from(e);if(null==o)return{ret:a,fd_obj:null};let{ret:l,entry:d}=this.dir.get_entry_for_path(o);if(null==d){if(l!=c)return{ret:l,fd_obj:null};if((r&L)!=L)return{ret:c,fd_obj:null};{const{ret:t,entry:n}=this.dir.create_entry_for_path(e,(r&z)==z);if(null==n)return{ret:t,fd_obj:null};d=n}}else if((r&E)==E)return{ret:f,fd_obj:null};return(r&z)==z&&d.stat().filetype!==A?{ret:p,fd_obj:null}:d.path_open(r,n,i)}path_create_directory(t){return this.path_open(0,t,L|z,0n,0n,0).ret}path_link(t,e,r){const{ret:n,path:s}=$.from(t);if(null==s)return n;if(s.is_dir)return c;const{ret:i,parent_entry:o,filename:l,entry:u}=this.dir.get_parent_dir_and_entry_for_path(s,!0);if(null==o||null==l)return i;if(null!=u){const t=e.stat().filetype==A,n=u.stat().filetype==A;if(t&&n){if(!(r&&u instanceof C))return f;if(0!=u.contents.size)return h}else{if(t&&!n)return p;if(!t&&n)return d;if(e.stat().filetype!=D||u.stat().filetype!=D)return f}}return r||e.stat().filetype!=A?(o.contents.set(l,e),a):g}path_unlink(t){const{ret:e,path:r}=$.from(t);if(null==r)return{ret:e,inode_obj:null};const{ret:n,parent_entry:s,filename:i,entry:o}=this.dir.get_parent_dir_and_entry_for_path(r,!0);return null==s||null==i?{ret:n,inode_obj:null}:null==o?{ret:c,inode_obj:null}:(s.contents.delete(i),{ret:a,inode_obj:o})}path_unlink_file(t){const{ret:e,path:r}=$.from(t);if(null==r)return e;const{ret:n,parent_entry:s,filename:i,entry:o}=this.dir.get_parent_dir_and_entry_for_path(r,!1);return null==s||null==i||null==o?n:o.stat().filetype===A?d:(s.contents.delete(i),a)}path_remove_directory(t){const{ret:e,path:r}=$.from(t);if(null==r)return e;const{ret:n,parent_entry:s,filename:i,entry:o}=this.dir.get_parent_dir_and_entry_for_path(r,!1);return null==s||null==i||null==o?n:o instanceof C&&o.stat().filetype===A?0!==o.contents.size?h:s.contents.delete(i)?a:c:p}fd_filestat_get(){return{ret:0,filestat:this.dir.stat()}}fd_filestat_set_size(t){return o}fd_read(t){return{ret:o,data:new Uint8Array}}fd_pread(t,e){return{ret:o,data:new Uint8Array}}fd_write(t){return{ret:o,nwritten:0}}fd_pwrite(t,e){return{ret:o,nwritten:0}}constructor(t){super(),this.dir=t}}class q extends Z{fd_prestat_get(){return{ret:0,prestat:M.dir(this.prestat_name)}}constructor(t,e){super(new C(e)),this.prestat_name=t}}class H extends R{path_open(t,e,r){if(this.readonly&&(e&BigInt(w))==BigInt(w))return{ret:g,fd_obj:null};if((t&V)==V){if(this.readonly)return{ret:g,fd_obj:null};this.data=new Uint8Array([])}const n=new G(this);return r&T&&n.fd_seek(0n,v),{ret:a,fd_obj:n}}get size(){return BigInt(this.data.byteLength)}stat(){return new N(D,this.size)}constructor(t,e){super(),this.data=new Uint8Array(t),this.readonly=!!e?.readonly}}let $=class t{static from(e){const r=new t;if(r.is_dir=e.endsWith("/"),e.startsWith("/"))return{ret:m,path:null};if(e.includes("\0"))return{ret:l,path:null};for(const t of e.split("/"))if(""!==t&&"."!==t)if(".."!==t)r.parts.push(t);else if(null==r.parts.pop())return{ret:m,path:null};return{ret:a,path:r}}to_path_string(){let t=this.parts.join("/");return this.is_dir&&(t+="/"),t}constructor(){this.parts=[],this.is_dir=!1}};class C extends R{path_open(t,e,r){return{ret:a,fd_obj:new Z(this)}}stat(){return new N(A,0n)}get_entry_for_path(t){let e=this;for(const r of t.parts){if(!(e instanceof C))return{ret:p,entry:null};const t=e.contents.get(r);if(void 0===t)return P.log(r),{ret:c,entry:null};e=t}return t.is_dir&&e.stat().filetype!=A?{ret:p,entry:null}:{ret:a,entry:e}}get_parent_dir_and_entry_for_path(t,e){const r=t.parts.pop();if(void 0===r)return{ret:l,parent_entry:null,filename:null,entry:null};const{ret:n,entry:s}=this.get_entry_for_path(t);if(null==s)return{ret:n,parent_entry:null,filename:null,entry:null};if(!(s instanceof C))return{ret:p,parent_entry:null,filename:null,entry:null};const i=s.contents.get(r);return void 0===i?e?{ret:a,parent_entry:s,filename:r,entry:null}:{ret:c,parent_entry:null,filename:null,entry:null}:t.is_dir&&i.stat().filetype!=A?{ret:p,parent_entry:null,filename:null,entry:null}:{ret:a,parent_entry:s,filename:r,entry:i}}create_entry_for_path(t,e){const{ret:r,path:n}=$.from(t);if(null==n)return{ret:r,entry:null};let s,{ret:i,parent_entry:o,filename:l,entry:d}=this.get_parent_dir_and_entry_for_path(n,!0);return null==o||null==l?{ret:i,entry:null}:null!=d?{ret:f,entry:null}:(P.log("create",n),s=e?new C(new Map):new H(new ArrayBuffer(0)),o.contents.set(l,s),d=s,{ret:a,entry:d})}constructor(t){super(),this.contents=t instanceof Array?new Map(t):t}}class K extends W{fd_filestat_get(){return{ret:0,filestat:new N(B,BigInt(0))}}fd_fdstat_get(){const t=new j(B,0);return t.fs_rights_base=BigInt(w),{ret:0,fdstat:t}}fd_write(t){return this.write(t),{ret:0,nwritten:t.byteLength}}static lineBuffered(t){const e=new TextDecoder("utf-8",{fatal:!1});let r="";return new K((n=>{r+=e.decode(n,{stream:!0});const s=r.split("\n");for(const[e,n]of s.entries())e<s.length-1?t(n):r=n}))}constructor(t){super(),this.write=t}}}},i={};function a(t){var e=i[t];if(void 0!==e)return e.exports;var r=i[t]={exports:{}};return s[t](r,r.exports,a),r.exports}t="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",e="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",r="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",n=t=>{t&&t.d<1&&(t.d=1,t.forEach((t=>t.r--)),t.forEach((t=>t.r--?t.r++:t())))},a.a=(s,i,a)=>{var o;a&&((o=[]).d=-1);var f,l,d,u=new Set,c=s.exports,_=new Promise(((t,e)=>{d=e,l=t}));_[e]=c,_[t]=t=>(o&&t(o),u.forEach(t),_.catch((t=>{}))),s.exports=_,i((s=>{var i;f=(s=>s.map((s=>{if(null!==s&&"object"==typeof s){if(s[t])return s;if(s.then){var i=[];i.d=0,s.then((t=>{a[e]=t,n(i)}),(t=>{a[r]=t,n(i)}));var a={};return a[t]=t=>t(i),a}}var o={};return o[t]=t=>{},o[e]=s,o})))(s);var a=()=>f.map((t=>{if(t[r])throw t[r];return t[e]})),l=new Promise((e=>{(i=()=>e(a)).r=0;var r=t=>t!==o&&!u.has(t)&&(u.add(t),t&&!t.d&&(i.r++,t.push(i)));f.map((e=>e[t](r)))}));return i.r?l:a()}),(t=>(t?d(_[r]=t):l(c),n(o)))),o&&o.d<0&&(o.d=0)},a.d=(t,e)=>{for(var r in e)a.o(e,r)&&!a.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),a.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a(265)})();